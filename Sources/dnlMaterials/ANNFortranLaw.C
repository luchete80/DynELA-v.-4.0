/**********************************************************************************
 *                                                                                *
 *  DynELA Finite Element Code v.4.0                                              *
 *  by Olivier PANTALE                                                            *
 *  Olivier.Pantale@enit.fr                                                       *
 *                                                                                *
 *********************************************************************************/
//@!CODEFILE = DynELA-C-file
//@!BEGIN = PRIVATE

// TODOCXYFILE

/*
  \file ANNFortranLaw.C
  Definition file for the ANNFortranLaw class

  This file is the definition file for the ANNFortranLaw class.

  \ingroup dnlMaterials
*/

#include <ANNFortranLaw.h>
#include <IntegrationPoint.h>
#include <Material.h>

//-----------------------------------------------------------------------------
ANNFortranLaw::ANNFortranLaw() : HardeningLaw()
//-----------------------------------------------------------------------------
{
  _lawType = ANNFortran;
  _lawName = "ANN 2HL Sigmoid Law";
  _yieldLaw = true;
}

//-----------------------------------------------------------------------------
ANNFortranLaw::ANNFortranLaw(const ANNFortranLaw &law) : HardeningLaw(law)
//-----------------------------------------------------------------------------
{
}

//-----------------------------------------------------------------------------
ANNFortranLaw::~ANNFortranLaw()
//-----------------------------------------------------------------------------
{
}

//-----------------------------------------------------------------------------
int ANNFortranLaw::getNumberOfParameters()
//-----------------------------------------------------------------------------
{
  return 0;
}

//-----------------------------------------------------------------------------
const char *ANNFortranLaw::getParameterName(int parameter)
//-----------------------------------------------------------------------------
{
  return "";
}

//-----------------------------------------------------------------------------
double &ANNFortranLaw::getParameter(int parameter)
//-----------------------------------------------------------------------------
{
  return dummy;
}

//-----------------------------------------------------------------------------
void ANNFortranLaw::setParameters(char *filename)
//-----------------------------------------------------------------------------
{
}

// 3-7-4-1 Sigmoid Model
//-----------------------------------------------------------------------------
double ANNFortranLaw::getYieldStress(double _epsp, double _depsp, double _T, double _dtime, IntegrationPoint *intPoint)
//-----------------------------------------------------------------------------
{
  double Yield;
  double xepsp, xdepsp, xtemp;
  double zb0, zb1, zb2, zb3, zb4, zb5, zb6;
  double zc0, zc1, zc2, zc3;

  xepsp = _epsp;
  if (_depsp > 1) {
    xdepsp = log(_depsp) /10.819778284410;
  }
  else {
    xdepsp = 0;
    _depsp = 1;
  }
  xtemp = (_T - 20.0)/480.0;

  zb0 = 1 + exp(-0.119231261313*xepsp - 0.173828095198*xdepsp + 1.827572464943*xtemp - 1.533527970314);
  zb1 = 1 + exp(-0.428523629904*xepsp - 0.572129368782*xdepsp + 1.296182870865*xtemp + 1.823030114174);
  zb2 = 1 + exp(132.502944946289*xepsp - 0.074804469943*xdepsp + 0.372308045626*xtemp + 1.611178278923);
  zb3 = 1 + exp(-0.238687828183*xepsp - 0.654297590256*xdepsp - 1.221466302872*xtemp - 0.61216711998);
  zb4 = 1 + exp(-0.216847836971*xepsp - 0.142032980919*xdepsp + 3.807989597321*xtemp - 0.042427442968);
  zb5 = 1 + exp(16.061351776123*xepsp - 0.11558868736*xdepsp + 0.41205266118*xtemp + 1.614393234253);
  zb6 = 1 + exp(3.10570526123*xepsp - 0.138235300779*xdepsp + 0.773996531963*xtemp + 1.072145581245);

  zc0 = exp(1.296875834465/zb0 + 1.162090778351/zb1 + 10.487031936646/zb2 + 0.098825834692/zb3 + 0.730871379375/zb4 - 4.092911243439/zb5 + 1.342621445656/zb6 + 0.492944657803);
  zc1 = exp(-0.416251301765/zb0 + 1.612317681313/zb1 - 1.245551109314/zb2 + 0.976023316383/zb3 + 0.005203731358/zb4 - 1.697751402855/zb5 - 0.834678351879/zb6 - 0.692925989628);
  zc2 = exp(-1.942471027374/zb0 - 0.364910364151/zb1 + 10.365681648254/zb2 - 0.165790036321/zb3 - 0.691674530506/zb4 - 5.159326076508/zb5 + 2.959228277206/zb6 - 0.345911204815);
  zc3 = exp(-1.463814258575/zb0 - 0.175867184997/zb1 + 0.67038166523/zb2 - 0.306437820196/zb3 - 0.191420003772/zb4 + 2.523961305618/zb5 + 0.034361626953/zb6 + 0.274670749903);

  Yield= 977.555715042962*(-1.342184662819/(1 + zc0) - 1.402877211571/(1 + zc1) + 1.547661781311/(1 + zc2) + 0.745113432407/(1 + zc3) - 0.319332510233)+ 579.184642915415;

  return Yield;
}

// 3-15-7-1 Sigmoid Model
/* //-----------------------------------------------------------------------------
double ANNFortranLaw::getYieldStress(double _epsp, double _depsp, double _T, double _dtime, IntegrationPoint *intPoint)
//-----------------------------------------------------------------------------
{
  double Yield;
  double xepsp, xdepsp, xtemp;
  double zb0, zb1, zb2, zb3, zb4, zb5, zb6, zb7, zb8, zb9, zb10, zb11, zb12, zb13, zb14;
  double zc0, zc1, zc2, zc3, zc4, zc5, zc6;

  xepsp = _epsp;
  if (_depsp > 1) {
    xdepsp = log(_depsp) /10.819778284410;
  }
  else {
    xdepsp = 0;
    _depsp = 1;
  }
  xtemp = (_T - 20.0)/480.0;
  
  zb0 = 1 + exp(0.012060621753*xepsp-0.095713630319*xdepsp+1.132768630981*xtemp-0.152942731977);
  zb1 = 1 + exp(0.294363111258*xepsp+0.238686338067*xdepsp-0.927507281303*xtemp-0.107671141624);
  zb2 = 1 + exp(-0.237155035138*xepsp-0.059818778187*xdepsp+1.12483894825*xtemp+0.063737362623);
  zb3 = 1 + exp(-2.144841194153*xepsp+1.129796504974*xdepsp+0.712961733341*xtemp-0.053180132061);
  zb4 = 1 + exp(-0.296413868666*xepsp+0.025504080579*xdepsp+1.094185471535*xtemp+0.490629643202);
  zb5 = 1 + exp(-48.906192779541*xepsp+0.079961933196*xdepsp-0.593655705452*xtemp-1.007660865784);
  zb6 = 1 + exp(0.257975906134*xepsp+0.812692463398*xdepsp+1.836528658867*xtemp+0.700909256935);
  zb7 = 1 + exp(-0.281009107828*xepsp-0.291400939226*xdepsp+1.235270857811*xtemp+0.33869895339);
  zb8 = 1 + exp(2.439829587936*xepsp+0.041996218264*xdepsp+1.377972126007*xtemp+0.018798789009);
  zb9 = 1 + exp(-0.019114091992*xepsp-0.440281480551*xdepsp+1.22192966938*xtemp+0.195074975491);
  zb10 = 1 + exp(-0.395223230124*xepsp+0.103723526001*xdepsp+1.429801106453*xtemp-0.004943652079);
  zb11 = 1 + exp(-0.252366125584*xepsp+0.399254202843*xdepsp-0.707565844059*xtemp+0.272255539894);
  zb12 = 1 + exp(-0.311952710152*xepsp+0.549723744392*xdepsp+1.112517356873*xtemp-0.074346348643);
  zb13 = 1 + exp(-0.469577252865*xepsp+0.514751732349*xdepsp-0.322931557894*xtemp+0.066414497793);
  zb14 = 1 + exp(0.905715465546*xepsp-0.585205674171*xdepsp-0.607724368572*xtemp+0.347484797239);

  zc0 = exp(-0.4298812747/zb0+0.338330149651/zb1-0.181947186589/zb2+0.506803691387/zb3-0.050830215216/zb4
    -1.06972193718/zb5+0.542937934399/zb6+0.19933372736/zb7+0.487417191267/zb8-0.322569102049/zb9+0.30666410923/zb10
    -0.014877121896/zb11+0.242582276464/zb12+0.351700603962/zb13-0.314847111702/zb14+0.028776543215);
  zc1 = exp(0.075511679053/zb0+0.296937316656/zb1-0.135893285275/zb2+0.111568406224/zb3+0.145156890154/zb4
    -0.789029717445/zb5+0.24453060329/zb6-0.560159265995/zb7+0.240995064378/zb8-0.077265538275/zb9-0.085220061243/zb10
    +0.312323272228/zb11-0.226731270552/zb12+0.502837955952/zb13+0.166889160872/zb14-0.004688098561);
  zc2 = exp(-0.258764863014/zb0+0.401719808578/zb1+0.182526275516/zb2+0.814248621464/zb3-0.32116869092/zb4
    -0.327172219753/zb5-0.129962816834/zb6-0.49340814352/zb7+0.805407047272/zb8-0.353788286448/zb9+0.468240350485/zb10
    +0.553911089897/zb11-0.014977829531/zb12+0.05037881434/zb13+0.496283948421/zb14+0.168565064669);
  zc3 = exp(-0.355580955744/zb0+0.325364142656/zb1-0.293511390686/zb2-0.219545319676/zb3-0.173273280263/zb4
    -0.986051380634/zb5+0.378076404333/zb6+0.240943789482/zb7+0.44318947196/zb8-0.525281190872/zb9+0.106048740447/zb10
    -0.038253538311/zb11+0.307359874249/zb12+0.49643471837/zb13-0.355081558228/zb14+0.117614813149);
  zc4 = exp(-0.388819903135/zb0-0.674088120461/zb1+0.168046966195/zb2+0.471695542336/zb3+0.341548472643/zb4
    +1.9083558321/zb5+0.306055963039/zb6+0.513388454914/zb7-0.937532782555/zb8+0.209101632237/zb9+0.315268725157/zb10
    +0.043373506516/zb11+0.316568374634/zb12-0.121681220829/zb13-0.668161571026/zb14-0.140419512987);
  zc5 = exp(0.566162824631/zb0-0.309225827456/zb1+0.307984143496/zb2-0.134523168206/zb3-0.170678853989/zb4
    +0.639720439911/zb5+0.079926304519/zb6+0.093051530421/zb7-0.575513899326/zb8+0.25140029192/zb9+0.412084698677/zb10
    -0.499665498734/zb11+0.061867456883/zb12-0.400538474321/zb13-0.043146558106/zb14+0.014178025536);
  zc6 = exp(0.459461212158/zb0-0.445904284716/zb1+0.490104675293/zb2+0.070082679391/zb3-0.14318652451/zb4
    +1.260733604431/zb5+0.663529634476/zb6-0.025558238849/zb7+0.266788393259/zb8+0.459608882666/zb9+0.358219951391/zb10
    -0.528843939304/zb11+0.328531950712/zb12-0.203891351819/zb13-0.511218845844/zb14-0.001133086509);
 
  Yield = 977.555715042962*(0.773557543755/(1 + zc0)+0.619582772255/(1 + zc1)+0.213743552566/(1 + zc2)+0.718253791332/(1 + zc3)
    -1.772530913353/(1 + zc4)-0.771725893021/(1 + zc5)-0.73087054491/(1 + zc6)-0.018919380382) + 579.184642915415; 

  return Yield;
} */

// 3-7-4-1 Sigmoid Model
//-----------------------------------------------------------------------------
double ANNFortranLaw::getDerivateYieldStress(double _epsp, double _depsp, double _T, double _dtime, IntegrationPoint *intPoint)
//-----------------------------------------------------------------------------
{
  double hard;
  double Yield;
  double dyieldDeqps1, dyieldDeqps2, dyieldDtemp;
  double xepsp, xdepsp, xtemp;
  double za0, za1, za2, za3, za4, za5, za6;
  double zb0, zb1, zb2, zb3, zb4, zb5, zb6;
  double zc0, zc1, zc2, zc3;
  double zd0, zd1, zd2, zd3, zd4, zd5, zd6;
  double ze0, ze1, ze2, ze3, ze4, ze5, ze6;
  double zf0, zf1, zf2, zf3, zf4, zf5, zf6;
  double yd0, yd1, yd2;
  double y;

  xepsp = _epsp;
  if (_depsp > 1) {
    xdepsp = log(_depsp) /10.819778284410;
  }
  else {
    xdepsp = 0;
    _depsp = 1;
  }
  xtemp = (_T - 20.0)/480.0;

  za0 = exp(-0.119231261313*xepsp - 0.173828095198*xdepsp + 1.827572464943*xtemp - 1.533527970314);
  za1 = exp(-0.428523629904*xepsp - 0.572129368782*xdepsp + 1.296182870865*xtemp + 1.823030114174);
  za2 = exp(132.502944946289*xepsp - 0.074804469943*xdepsp + 0.372308045626*xtemp + 1.611178278923);
  za3 = exp(-0.238687828183*xepsp - 0.654297590256*xdepsp - 1.221466302872*xtemp - 0.61216711998);
  za4 = exp(-0.216847836971*xepsp - 0.142032980919*xdepsp + 3.807989597321*xtemp - 0.042427442968);
  za5 = exp(16.061351776123*xepsp - 0.11558868736*xdepsp + 0.41205266118*xtemp + 1.614393234253);
  za6 = exp(3.10570526123*xepsp - 0.138235300779*xdepsp + 0.773996531963*xtemp + 1.072145581245);

  zb0 = 1 + za0;
  zb1 = 1 + za1;
  zb2 = 1 + za2;
  zb3 = 1 + za3;
  zb4 = 1 + za4;
  zb5 = 1 + za5;
  zb6 = 1 + za6;

  zc0 = exp(1.296875834465/zb0 + 1.162090778351/zb1 + 10.487031936646/zb2 + 0.098825834692/zb3 + 0.730871379375/zb4 - 4.092911243439/zb5 + 1.342621445656/zb6 + 0.492944657803);
  zc1 = exp(-0.416251301765/zb0 + 1.612317681313/zb1 - 1.245551109314/zb2 + 0.976023316383/zb3 + 0.005203731358/zb4 - 1.697751402855/zb5 - 0.834678351879/zb6 - 0.692925989628);
  zc2 = exp(-1.942471027374/zb0 - 0.364910364151/zb1 + 10.365681648254/zb2 - 0.165790036321/zb3 - 0.691674530506/zb4 - 5.159326076508/zb5 + 2.959228277206/zb6 - 0.345911204815);
  zc3 = exp(-1.463814258575/zb0 - 0.175867184997/zb1 + 0.67038166523/zb2 - 0.306437820196/zb3 - 0.191420003772/zb4 + 2.523961305618/zb5 + 0.034361626953/zb6 + 0.274670749903);

  y =-1.342184662819/(1 + zc0) - 1.402877211571/(1 + zc1) + 1.547661781311/(1 + zc2) + 0.745113432407/(1 + zc3) - 0.319332510233;

  zd0 =-1.342184662819*(zc0/pow(1 + zc0,2));
  zd1 =-1.402877211571*(zc1/pow(1 + zc1,2));
  zd2 = 1.547661781311*(zc2/pow(1 + zc2,2));
  zd3 = 0.745113432407*(zc3/pow(1 + zc3,2));

  ze0 = za0 / pow(zb0, 2);
  ze1 = za1 / pow(zb1, 2);
  ze2 = za2 / pow(zb2, 2);
  ze3 = za3 / pow(zb3, 2);
  ze4 = za4 / pow(zb4, 2);
  ze5 = za5 / pow(zb5, 2);
  ze6 = za6 / pow(zb6, 2);

  zf0 = (-1.296875834465*zd0 + 0.416251301765*zd1 + 1.942471027374*zd2 + 1.463814258575*zd3)*ze0;
  zf1 = (-1.162090778351*zd0 - 1.612317681313*zd1 + 0.364910364151*zd2 + 0.175867184997*zd3)*ze1;
  zf2 = (-10.487031936646*zd0 + 1.245551109314*zd1 - 10.365681648254*zd2 - 0.67038166523*zd3)*ze2;
  zf3 = (-0.098825834692*zd0 - 0.976023316383*zd1 + 0.165790036321*zd2 + 0.306437820196*zd3)*ze3;
  zf4 = (-0.730871379375*zd0 - 0.005203731358*zd1 + 0.691674530506*zd2 + 0.191420003772*zd3)*ze4;
  zf5 = (4.092911243439*zd0 + 1.697751402855*zd1 + 5.159326076508*zd2 - 2.523961305618*zd3)*ze5;
  zf6 = (-1.342621445656*zd0 + 0.834678351879*zd1 - 2.959228277206*zd2 - 0.034361626953*zd3)*ze6;

  yd0 = 0.119231261313*zf0 + 0.428523629904*zf1 - 132.502944946289*zf2 + 0.238687828183*zf3 + 0.216847836971*zf4 - 16.061351776123*zf5 - 3.10570526123*zf6;
  yd1 = 0.173828095198*zf0 + 0.572129368782*zf1 + 0.074804469943*zf2 + 0.654297590256*zf3 + 0.142032980919*zf4 + 0.11558868736*zf5 + 0.138235300779*zf6;
  yd2 =-1.827572464943*zf0 - 1.296182870865*zf1 - 0.372308045626*zf2 + 1.221466302872*zf3 - 3.807989597321*zf4 - 0.41205266118*zf5 - 0.773996531963*zf6;

  Yield= 977.555715042962*y+ 579.184642915415;
  dyieldDeqps1 = 977.555715042962*yd0;
  dyieldDeqps2 = 90.348959964501*yd1 / _depsp;
  dyieldDtemp = 2.036574406340*yd2; 

  hard = dyieldDeqps1 + dyieldDeqps2 / _dtime + _material->taylorQuinney / (_material->density * _material->heatCapacity) * Yield * dyieldDtemp;

  return hard;
}

// 3-15-7-1 Sigmoid Model
/* //-----------------------------------------------------------------------------
double ANNFortranLaw::getDerivateYieldStress(double _epsp, double _depsp, double _T, double _dtime, IntegrationPoint *intPoint)
//-----------------------------------------------------------------------------
{
  double hard;
  double Yield;
  double dyieldDeqps1, dyieldDeqps2, dyieldDtemp;
  double xepsp, xdepsp, xtemp;
  double za0, za1, za2, za3, za4, za5, za6, za7, za8, za9, za10, za11, za12, za13, za14;
  double zb0, zb1, zb2, zb3, zb4, zb5, zb6, zb7, zb8, zb9, zb10, zb11, zb12, zb13, zb14;
  double zc0, zc1, zc2, zc3, zc4, zc5, zc6;
  double zd0, zd1, zd2, zd3, zd4, zd5, zd6;
  double ze0, ze1, ze2, ze3, ze4, ze5, ze6, ze7, ze8, ze9, ze10, ze11, ze12, ze13, ze14;
  double zf0, zf1, zf2, zf3, zf4, zf5, zf6, zf7, zf8, zf9, zf10, zf11, zf12, zf13, zf14;
  double yd0, yd1, yd2;
  double y;

  xepsp = _epsp;
  if (_depsp > 1) {
    xdepsp = log(_depsp) /10.819778284410;
  }
  else {
    xdepsp = 0;
    _depsp = 1;
  }
  xtemp = (_T - 20.0)/480.0;
  
  za0 = exp(0.012060621753*xepsp-0.095713630319*xdepsp+1.132768630981*xtemp-0.152942731977);
  za1 = exp(0.294363111258*xepsp+0.238686338067*xdepsp-0.927507281303*xtemp-0.107671141624);
  za2 = exp(-0.237155035138*xepsp-0.059818778187*xdepsp+1.12483894825*xtemp+0.063737362623);
  za3 = exp(-2.144841194153*xepsp+1.129796504974*xdepsp+0.712961733341*xtemp-0.053180132061);
  za4 = exp(-0.296413868666*xepsp+0.025504080579*xdepsp+1.094185471535*xtemp+0.490629643202);
  za5 = exp(-48.906192779541*xepsp+0.079961933196*xdepsp-0.593655705452*xtemp-1.007660865784);
  za6 = exp(0.257975906134*xepsp+0.812692463398*xdepsp+1.836528658867*xtemp+0.700909256935);
  za7 = exp(-0.281009107828*xepsp-0.291400939226*xdepsp+1.235270857811*xtemp+0.33869895339);
  za8 = exp(2.439829587936*xepsp+0.041996218264*xdepsp+1.377972126007*xtemp+0.018798789009);
  za9 = exp(-0.019114091992*xepsp-0.440281480551*xdepsp+1.22192966938*xtemp+0.195074975491);
  za10 = exp(-0.395223230124*xepsp+0.103723526001*xdepsp+1.429801106453*xtemp-0.004943652079);
  za11 = exp(-0.252366125584*xepsp+0.399254202843*xdepsp-0.707565844059*xtemp+0.272255539894);
  za12 = exp(-0.311952710152*xepsp+0.549723744392*xdepsp+1.112517356873*xtemp-0.074346348643);
  za13 = exp(-0.469577252865*xepsp+0.514751732349*xdepsp-0.322931557894*xtemp+0.066414497793);
  za14 = exp(0.905715465546*xepsp-0.585205674171*xdepsp-0.607724368572*xtemp+0.347484797239);

  zb0 = 1.0 + za0;
  zb1 = 1.0 + za1;
  zb2 = 1.0 + za2;
  zb3 = 1.0 + za3;
  zb4 = 1.0 + za4;
  zb5 = 1.0 + za5;
  zb6 = 1.0 + za6;
  zb7 = 1.0 + za7;
  zb8 = 1.0 + za8;
  zb9 = 1.0 + za9;
  zb10 = 1.0 + za10;
  zb11 = 1.0 + za11;
  zb12 = 1.0 + za12;
  zb13 = 1.0 + za13;
  zb14 = 1.0 + za14;

  zc0 = exp(-0.4298812747/zb0+0.338330149651/zb1-0.181947186589/zb2+0.506803691387/zb3-0.050830215216/zb4-1.06972193718/zb5+0.542937934399/zb6
    +0.19933372736/zb7+0.487417191267/zb8-0.322569102049/zb9+0.30666410923/zb10-0.014877121896/zb11+0.242582276464/zb12+0.351700603962/zb13
    -0.314847111702/zb14+0.028776543215);
  zc1 = exp(0.075511679053/zb0+0.296937316656/zb1-0.135893285275/zb2+0.111568406224/zb3+0.145156890154/zb4-0.789029717445/zb5+0.24453060329/zb6
    -0.560159265995/zb7+0.240995064378/zb8-0.077265538275/zb9-0.085220061243/zb10+0.312323272228/zb11-0.226731270552/zb12+0.502837955952/zb13
    +0.166889160872/zb14-0.004688098561);
  zc2 = exp(-0.258764863014/zb0+0.401719808578/zb1+0.182526275516/zb2+0.814248621464/zb3-0.32116869092/zb4-0.327172219753/zb5-0.129962816834/zb6
    -0.49340814352/zb7+0.805407047272/zb8-0.353788286448/zb9+0.468240350485/zb10+0.553911089897/zb11-0.014977829531/zb12+0.05037881434/zb13
    +0.496283948421/zb14+0.168565064669);
  zc3 = exp(-0.355580955744/zb0+0.325364142656/zb1-0.293511390686/zb2-0.219545319676/zb3-0.173273280263/zb4-0.986051380634/zb5+0.378076404333/zb6
    +0.240943789482/zb7+0.44318947196/zb8-0.525281190872/zb9+0.106048740447/zb10-0.038253538311/zb11+0.307359874249/zb12+0.49643471837/zb13
    -0.355081558228/zb14+0.117614813149);
  zc4 = exp(-0.388819903135/zb0-0.674088120461/zb1+0.168046966195/zb2+0.471695542336/zb3+0.341548472643/zb4+1.9083558321/zb5+0.306055963039/zb6
    +0.513388454914/zb7-0.937532782555/zb8+0.209101632237/zb9+0.315268725157/zb10+0.043373506516/zb11+0.316568374634/zb12-0.121681220829/zb13
    -0.668161571026/zb14-0.140419512987);
  zc5 = exp(0.566162824631/zb0-0.309225827456/zb1+0.307984143496/zb2-0.134523168206/zb3-0.170678853989/zb4+0.639720439911/zb5+0.079926304519/zb6
    +0.093051530421/zb7-0.575513899326/zb8+0.25140029192/zb9+0.412084698677/zb10-0.499665498734/zb11+0.061867456883/zb12-0.400538474321/zb13
    -0.043146558106/zb14+0.014178025536);
  zc6 = exp(0.459461212158/zb0-0.445904284716/zb1+0.490104675293/zb2+0.070082679391/zb3-0.14318652451/zb4+1.260733604431/zb5+0.663529634476/zb6
    -0.025558238849/zb7+0.266788393259/zb8+0.459608882666/zb9+0.358219951391/zb10-0.528843939304/zb11+0.328531950712/zb12-0.203891351819/zb13
    -0.511218845844/zb14-0.001133086509);
 
  y = 0.773557543755/(1 + zc0)+0.619582772255/(1 + zc1)+0.213743552566/(1 + zc2)+0.718253791332/(1 + zc3)-1.772530913353/(1 + zc4)
    -0.771725893021/(1 + zc5)-0.73087054491/(1 + zc6)-0.018919380382;

  zd0 = 0.773557543755*(zc0/pow(1 + zc0, 2));
  zd1 = 0.619582772255*(zc1/pow(1 + zc1, 2));
  zd2 = 0.213743552566*(zc2/pow(1 + zc2, 2));
  zd3 = 0.718253791332*(zc3/pow(1 + zc3, 2));
  zd4 =-1.772530913353*(zc4/pow(1 + zc4, 2));
  zd5 =-0.771725893021*(zc5/pow(1 + zc5, 2));
  zd6 =-0.73087054491*(zc6/pow(1 + zc6, 2));
     
  ze0 = za0 / pow(zb0, 2);
  ze1 = za1 / pow(zb1, 2);
  ze2 = za2 / pow(zb2, 2);
  ze3 = za3 / pow(zb3, 2);
  ze4 = za4 / pow(zb4, 2);
  ze5 = za5 / pow(zb5, 2);
  ze6 = za6 / pow(zb6, 2);
  ze7 = za7 / pow(zb7, 2);
  ze8 = za8 / pow(zb8, 2);
  ze9 = za9 / pow(zb9, 2);
  ze10 = za10 / pow(zb10, 2);
  ze11 = za11 / pow(zb11, 2);
  ze12 = za12 / pow(zb12, 2);
  ze13 = za13 / pow(zb13, 2);
  ze14 = za14 / pow(zb14, 2);

  zf0 = (0.4298812747*zd0-0.075511679053*zd1+0.258764863014*zd2+0.355580955744*zd3+0.388819903135*zd4-0.566162824631*zd5-0.459461212158*zd6)*ze0;
  zf1 = (-0.338330149651*zd0-0.296937316656*zd1-0.401719808578*zd2-0.325364142656*zd3+0.674088120461*zd4+0.309225827456*zd5+0.445904284716*zd6)*ze1;
  zf2 = (0.181947186589*zd0+0.135893285275*zd1-0.182526275516*zd2+0.293511390686*zd3-0.168046966195*zd4-0.307984143496*zd5-0.490104675293*zd6)*ze2;
  zf3 = (-0.506803691387*zd0-0.111568406224*zd1-0.814248621464*zd2+0.219545319676*zd3-0.471695542336*zd4+0.134523168206*zd5-0.070082679391*zd6)*ze3;
  zf4 = (0.050830215216*zd0-0.145156890154*zd1+0.32116869092*zd2+0.173273280263*zd3-0.341548472643*zd4+0.170678853989*zd5+0.14318652451*zd6)*ze4;
  zf5 = (1.06972193718*zd0+0.789029717445*zd1+0.327172219753*zd2+0.986051380634*zd3-1.9083558321*zd4-0.639720439911*zd5-1.260733604431*zd6)*ze5;
  zf6 = (-0.542937934399*zd0-0.24453060329*zd1+0.129962816834*zd2-0.378076404333*zd3-0.306055963039*zd4-0.079926304519*zd5-0.663529634476*zd6)*ze6;
  zf7 = (-0.19933372736*zd0+0.560159265995*zd1+0.49340814352*zd2-0.240943789482*zd3-0.513388454914*zd4-0.093051530421*zd5+0.025558238849*zd6)*ze7;
  zf8 = (-0.487417191267*zd0-0.240995064378*zd1-0.805407047272*zd2-0.44318947196*zd3+0.937532782555*zd4+0.575513899326*zd5-0.266788393259*zd6)*ze8;
  zf9 = (0.322569102049*zd0+0.077265538275*zd1+0.353788286448*zd2+0.525281190872*zd3-0.209101632237*zd4-0.25140029192*zd5-0.459608882666*zd6)*ze9;
  zf10 = (-0.30666410923*zd0+0.085220061243*zd1-0.468240350485*zd2-0.106048740447*zd3-0.315268725157*zd4-0.412084698677*zd5-0.358219951391*zd6)*ze10;
  zf11 = (0.014877121896*zd0-0.312323272228*zd1-0.553911089897*zd2+0.038253538311*zd3-0.043373506516*zd4+0.499665498734*zd5+0.528843939304*zd6)*ze11;
  zf12 = (-0.242582276464*zd0+0.226731270552*zd1+0.014977829531*zd2-0.307359874249*zd3-0.316568374634*zd4-0.061867456883*zd5-0.328531950712*zd6)*ze12;
  zf13 = (-0.351700603962*zd0-0.502837955952*zd1-0.05037881434*zd2-0.49643471837*zd3+0.121681220829*zd4+0.400538474321*zd5+0.203891351819*zd6)*ze13;
  zf14 = (0.314847111702*zd0-0.166889160872*zd1-0.496283948421*zd2+0.355081558228*zd3+0.668161571026*zd4+0.043146558106*zd5+0.511218845844*zd6)*ze14;

  yd0 =-0.012060621753*zf0-0.294363111258*zf1+0.237155035138*zf2+2.144841194153*zf3+0.296413868666*zf4+48.906192779541*zf5-0.257975906134*zf6
    +0.281009107828*zf7-2.439829587936*zf8+0.019114091992*zf9+0.395223230124*zf10+0.252366125584*zf11+0.311952710152*zf12+0.469577252865*zf13-0.905715465546*zf14;
  yd1 = 0.095713630319*zf0-0.238686338067*zf1+0.059818778187*zf2-1.129796504974*zf3-0.025504080579*zf4-0.079961933196*zf5-0.812692463398*zf6
    +0.291400939226*zf7-0.041996218264*zf8+0.440281480551*zf9-0.103723526001*zf10-0.399254202843*zf11-0.549723744392*zf12-0.514751732349*zf13+0.585205674171*zf14;
  yd2 =-1.132768630981*zf0+0.927507281303*zf1-1.12483894825*zf2-0.712961733341*zf3-1.094185471535*zf4+0.593655705452*zf5-1.836528658867*zf6
    -1.235270857811*zf7-1.377972126007*zf8-1.22192966938*zf9-1.429801106453*zf10+0.707565844059*zf11-1.112517356873*zf12+0.322931557894*zf13+0.607724368572*zf14;
    
  Yield= 977.555715042962*y+ 579.184642915415;
  dyieldDeqps1 = 977.555715042962*yd0;
  dyieldDeqps2 = 90.348959964501*yd1 / _depsp;
  dyieldDtemp = 2.036574406340*yd2;

  hard = dyieldDeqps1 + dyieldDeqps2 / _dtime + _material->taylorQuinney / (_material->density * _material->heatCapacity) * Yield * dyieldDtemp;

  return hard;
}
 */
